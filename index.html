<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èª²ç¨‹ç·šä¸Šæ‰“å¡ç³»çµ± (Firebase)</title>
    <style>
        /* -------------------------------------
         * 1. åŸºç¤ä½ˆå±€èˆ‡å­—é«”
         * ------------------------------------- */
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 550px;
            margin: 30px auto;
            padding: 20px;
            text-align: center;
            border: 1px solid #ccc;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            background-color: #fff;
        }
        h1 { color: #007bff; margin-bottom: 20px; }
        h2 { color: #333; margin-bottom: 15px; }
        
        /* -------------------------------------
         * 2. è¡¨å–®å…ƒç´ èˆ‡æŒ‰éˆ•
         * ------------------------------------- */
        input[type="password"], 
        input[type="text"] {
            width: calc(100% - 20px); 
            padding: 12px;
            margin: 10px 0;
            border: 1px solid #aaa;
            border-radius: 5px;
            box-sizing: border-box;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 12px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 17px;
            width: 100%;
            box-sizing: border-box;
            margin-top: 10px;
            transition: background-color 0.3s;
        }

        /* -------------------------------------
         * 3. éšæ®µèˆ‡ç‹€æ…‹é¡¯ç¤º
         * ------------------------------------- */
        .stage { 
            margin-bottom: 25px; 
            padding: 20px; 
            border: 1px dashed #ddd; 
            border-radius: 8px; 
            background-color: #fafafa; 
        }
        
        /* â— ä¿®æ­£ï¼šå¼·åˆ¶éš±è—é¸é …æ¡†ï¼Œè§£æ±ºæ¬Šé‡è¡çª */
        .hidden { 
            display: none !important; 
        }
        
        .error-message { color: red; margin-top: 15px; font-weight: bold; }
        .result-box { background-color: #e9ecef; padding: 20px; border-radius: 8px; text-align: left; margin-top: 20px; border-left: 5px solid #28a745; }
        .highlight { color: #d9534f; font-weight: bold; }
        
        /* -------------------------------------
         * 4. å»ºæª”è¡¨å–® (INFO STAGE) ä¿®æ­£å€
         * ------------------------------------- */
        
        /* â— ä¿®æ­£ï¼šå¼·åˆ¶ label ç¨ä½”ä¸€è¡Œï¼Œè§£æ±ºæ’ç‰ˆæ··äº‚ */
        #info-form label {
            display: block; 
            text-align: left; 
            margin-top: 15px;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        
        /* ç¢ºä¿ info-form å…§çš„è¼¸å…¥æ¡†éƒ½æ˜¯å…¨å¯¬ */
        #info-form input[type="text"], 
        #info-form input[type="password"] {
            width: 100%;
        }

        /* -------------------------------------
         * 5. æ§åˆ¶æŒ‰éˆ•èˆ‡ç‰¹æ®ŠæŒ‰éˆ•
         * ------------------------------------- */
        
        .password-controls-row { display: flex; gap: 1%; margin-top: 15px; }
        .password-controls-row button { width: 49%; margin: 0; }
        .mode-switch-button { background-color: #17a2b8 !important; } 
        .admin-button { background-color: #6c757d !important; }
        .new-user-button { background-color: #ffc107; color: #333; margin-top: 15px; } 

        /* -------------------------------------
         * 6. æ‰‹å‹•ç¯€æ¬¡é¸æ“‡å€å¡Š
         * ------------------------------------- */
        .section-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            padding: 15px;
            background-color: #f0f0f0;
            border-radius: 5px;
            margin-top: 15px;
            text-align: left;
            border: 1px solid #ddd;
        }
        .section-selector label {
            display: flex; align-items: center; cursor: pointer; padding: 8px; border: 1px solid #ccc; border-radius: 4px; transition: background-color 0.2s; font-size: 0.9em; user-select: none;
        }
        .section-selector label:hover { background-color: #e2e2e2; }
        .section-selector input[type="checkbox"] { margin-right: 8px; width: auto; }
        .section-selector input[type="checkbox"]:checked + span { font-weight: bold; color: #007bff;}

        /* -------------------------------------
         * 7. ç‰ˆæ¬Šè³‡è¨Š
         * ------------------------------------- */
        .footer-copyright {
            position: fixed; bottom: 5px; right: 10px; font-size: 12px; color: #ccc; opacity: 0.7;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>ç·šä¸Šæ‰“å¡ç³»çµ± (é›²ç«¯)</h1>

        <div id="password-stage" class="stage">
            <h2>ğŸ”‘ è«‹è¼¸å…¥æ‚¨çš„**å°ˆå±¬å¯†èª**</h2>
            <input type="password" id="password-input" placeholder="è¼¸å…¥æ‚¨çš„å°ˆå±¬å¯†èª...">
            
            <div id="auto-section-status" style="margin-bottom: 10px; color: #28a745; font-weight: bold;">
                ğŸŸ¢ **ç›®å‰æ¨¡å¼ï¼šè‡ªå‹•ç¯€æ¬¡åˆ¤æ–·**
            </div>

            <div id="manual-section-stage" class="section-selector hidden">
                <strong>æ‰‹å‹•é¸æ“‡ç¯€æ¬¡ (å¯è¤‡é¸):</strong>
                <label><input type="checkbox" name="manual_section" value="ğŸš© å‡æ——"> <span>å‡æ——</span></label>
                <label><input type="checkbox" name="manual_section" value="ç¬¬ 1 ç¯€ (08:10)"> <span>1 ç¯€</span></label>
                <label><input type="checkbox" name="manual_section" value="ç¬¬ 2 ç¯€ (09:00)"> <span>2 ç¯€</span></label>
                <label><input type="checkbox" name="manual_section" value="ç¬¬ 3 ç¯€ (10:10)"> <span>3 ç¯€</span></label>
                <label><input type="checkbox" name="manual_section" value="ç¬¬ 4 ç¯€ (11:00)"> <span>4 ç¯€</span></label>
                <label><input type="checkbox" name="manual_section" value="ğŸš åˆä¼‘ (12:00)"> <span>åˆä¼‘</span></label>
                <label><input type="checkbox" name="manual_section" value="ç¬¬ 5 ç¯€ (13:20)"> <span>5 ç¯€</span></label>
                <label><input type="checkbox" name="manual_section" value="ç¬¬ 6 ç¯€ (14:10)"> <span>6 ç¯€</span></label>
                <label><input type="checkbox" name="manual_section" value="ç¬¬ 7 ç¯€ (15:20)"> <span>7 ç¯€</span></label>
                <label><input type="checkbox" name="manual_section" value="ç¬¬ 8 ç¯€ (16:10)"> <span>8 ç¯€</span></label>
                <label><input type="checkbox" name="manual_section" value="ğŸšŒ æ”¾å­¸/èª²å¾Œ (17:00)"> <span>æ”¾å­¸</span></label>
            </div>
            
            <div class="password-controls-row">
                <button onclick="checkPassword()">ç¢ºèªå¯†èªä¸¦æ‰“å¡</button>
                <button class="mode-switch-button" onclick="toggleManualMode()">åˆ‡æ›ç¯€æ¬¡æ¨¡å¼</button>
            </div>

            <div class="password-controls">
                <a href="admin.html" target="_blank" style="text-decoration: none; width: 100%;">
                    <button class="admin-button">æˆ‘æ˜¯ç®¡ç†å“¡ ğŸ’»</button>
                </a>
            </div>
            
            <button class="new-user-button" onclick="showInfoStage()">ğŸ†• æˆ‘æ˜¯ç¬¬ä¸€æ¬¡ç”¨ï¼æˆ‘è¦å»ºæª”</button>

            <p id="password-error" class="error-message"></p>
        </div>

        <div id="info-stage" class="stage hidden">
            <h2>ğŸ“ é¦–æ¬¡ä½¿ç”¨ï¼šå»ºç«‹å°ˆå±¬å¯†èªä¸¦å»ºæª”</h2>
            <form id="info-form">
                <p class="instruction-text">è«‹å»ºç«‹æ‚¨çš„**å°ˆå±¬é€šé—œå¯†èª** (ä¸‹æ¬¡æ‰“å¡ä½¿ç”¨)ï¼Œä¸¦å¡«å¯«å€‹äººè³‡æ–™ã€‚</p>

                <label for="personal-password-input">å»ºç«‹æ‚¨çš„å¯†èªï¼š</label>
                <input type="password" id="personal-password-input" required placeholder="è¨­å®š 6 ä½æ•¸ä»¥ä¸Šçš„å¯†èª">
                
                <label for="class-input">ç­ç´šï¼š</label>
                <input type="text" id="class-input" required placeholder="ä¾‹å¦‚ï¼šè³‡è¨Šä¸€ç”²">

                <label for="name-input">å§“åï¼š</label>
                <input type="text" id="name-input" required placeholder="ä¾‹å¦‚ï¼šç‹å°æ˜">

                <label for="student-id-input">å­¸è™Ÿï¼š</label>
                <input type="text" id="student-id-input" required placeholder="ä¾‹å¦‚ï¼šA12345678">

                <button type="submit">âœ… å®Œæˆå»ºæª”ä¸¦æ‰“å¡</button>
            </form>
            <button onclick="resetData()" style="background-color: #dc3545; margin-top: 15px;">å–æ¶ˆä¸¦è¿”å›</button>
        </div>

        <div id="success-stage" class="stage hidden">
            <h2>âœ… æ‰“å¡æˆåŠŸï¼</h2>
            <div class="result-box">
                <p><strong>ç­ç´š:</strong> <span id="display-class"></span></p>
                <p><strong>å§“å:</strong> <span id="display-name"></span></p>
                <p><strong>å­¸è™Ÿ:</strong> <span id="display-student-id"></span></p>
                <p class="highlight"><strong>ğŸ—“ï¸ æ‰“å¡æ—¥æœŸ:</strong> <span id="display-date"></span></p>
                <p class="highlight"><strong>â° æœ¬æ¬¡ç¯€æ¬¡:</strong> <span id="display-section"></span></p>
                <p><small>æ‰“å¡æ™‚é–“: <span id="display-timestamp"></span></small></p>
            </div>
            
            <p id="upload-status" style="color: green; margin-top: 15px;">ğŸ”¥ ç´€éŒ„å·²å³æ™‚å‚³é€è‡³é›²ç«¯ã€‚</p>
            
            <button onclick="resetData()" style="background-color: #007bff; margin-top: 15px;">â¬…ï¸ è¿”å›æ‰“å¡ä»‹é¢</button>
        </div>
    </div>
    
    <div class="footer-copyright">
        Power by Ericqw
    </div>

    <script src="script.js" type="module"></script>
</body>
</html>
